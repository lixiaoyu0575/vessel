<br>
<div nz-row>
    <div nz-col>
        <nz-card>
            <ng-template #title>健康体检调查表</ng-template>
            <ng-template #body>

                <div nz-row [nzGutter]="16">
                    <div nz-col [nzMd]="24">
                        <nz-card>
                            <ng-template #title>调查表总览</ng-template>
                            <ng-template #body>
                                <nz-table #nzTable [nzDataSource]="data" [nzPageSize]="10">
                                    <thead nz-thead>
                                    <tr>
                                        <th nz-th><span>PID</span></th>
                                        <th nz-th><span>姓名</span></th>
                                        <th nz-th><span>体检编号</span></th>
                                        <th nz-th><span>状态</span></th>
                                        <th nz-th><span>上次修改时间</span></th>
                                        <th nz-th><span>操作</span></th>

                                    </tr>
                                    </thead>
                                    <tbody nz-tbody>
                                    <tr nz-tbody-tr *ngFor="let data of nzTable.data">
                                        <td nz-td>{{data.PID}}</td>
                                        <td nz-td>{{data.Name}}</td>
                                        <td nz-td>{{data.No}}</td>
                                        <td nz-td>{{data.Status}}</td>
                                        <td nz-td>{{data.Updated_time}}</td>
                                        <td nz-td>
                                            <!--前段根据四种权限，对应有不同的操作组合。-->
                                            <!---->
                                            <span *ngIf="userGroup === 1">
                                                      <a [routerLink]="'/survey/first_step/'+ data.PID">查看</a>
                                                      <span nz-table-divider></span>
                                            </span>
                                            <span *ngIf="userGroup ===3 && userProvince === data.Province">
                                                      <a [routerLink]="'/survey/first_step/' + data.PID">查看</a>
                                                      <span nz-table-divider></span>
                                            </span>
                                            <span *ngIf="userGroup ===2 && userProvince === data.Province">
                                                      <a [routerLink]="'/survey/first_step/' + data.PID">查看</a>
                                                      <span nz-table-divider></span>
                                            </span>

                                            <span *ngIf="userGroup ===4 && loggedUser === data.completedBy">
                                                      <a [routerLink]="'/survey/first_step' +  + data.PID">查看</a>
                                                <span nz-table-divider></span>
                                                  </span>

                                            <span *ngIf="userGroup < 4">
                                                      <a (click)="deleteRecord(data.PID)" >删除</a>
                                                      <span nz-table-divider></span>
                                                  </span>

                                            <span *ngIf="userGroup === 4 && loggedUser === data.completedBy">
                                                      <a (click)="deleteRecord(data.PID)">删除</a>
                                                      <span nz-table-divider></span>
                                                  </span>

                                            <span>
                                                <a (click)="downloadByPID(data.PID)">下载</a>
                                                <span nz-table-divider></span>
                                            </span>
                                        </td>
                                    </tr>
                                    </tbody>
                                </nz-table>
                            </ng-template>
                        </nz-card>
                    </div>
                </div>


                <div nz-row [nzGutter]="40">
                    <div nz-col [nzSpan]="6">
                        <button nz-button [nzType]="'primary'" [nzSize]="'large'" [nzShape]="'circle'" [routerLink]="['/survey/first_step']" class="mr-sm">
                            <i class="anticon anticon-plus"></i>
                        </button>
                        新增
                    </div>
                    <div nz-col [nzSpan]="6"></div>
                    <div nz-col [nzSpan]="6"></div>
                    <div nz-col [nzSpan]="6">
                        <button nz-button [nzType]="'primary'" [nzSize]="'large'" [nzShape]="'circle'" class="mr-sm" (click)="downloadAll()">
                            <i class="anticon anticon-download"></i>
                        </button>
                        下载所有数据
                    </div>
                </div>
                
         
            </ng-template>
        </nz-card>
    </div>
</div>
